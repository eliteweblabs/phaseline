---
// SEO Component
// ------------
// Description: Adds SEO meta tags to the page.
// Properties:
// - Title: the page title
// - Description: the page description
// - OgImage: the Open Graph image URL
// - Canonical: whether to include canonical URL
// - Noindex: whether to add noindex and nofollow meta tags

// Props
type Props = {
	title?: string
	description?: string
	ogImage?: string
	canonical?: boolean
	noindex?: boolean
}

const { title, description, ogImage, canonical, noindex } = Astro.props

// Convert relative OG image path to absolute URL for social media sharing
const getAbsoluteOgImage = (imagePath: string | undefined) => {
	if (!imagePath) return ''
	// If already an absolute URL, return as is
	if (imagePath.startsWith('http://') || imagePath.startsWith('https://')) {
		return imagePath
	}
	// Convert relative path to absolute URL
	const baseUrl = Astro.site || Astro.url.origin
	return new URL(imagePath, baseUrl).toString()
}

const absoluteOgImage = getAbsoluteOgImage(ogImage)
---

<Fragment>
	<title>{title}</title>
	<meta name="description" content={description} />
	<meta property="og:type" content="website" />
	<meta property="og:url" content={Astro.url} />
	<meta property="og:title" content={title} />
	<meta property="og:description" content={description} />
	<meta property="og:image" content={absoluteOgImage} />
	<meta property="og:image:width" content="1200" />
	<meta property="og:image:height" content="630" />
	<meta property="twitter:card" content="summary_large_image" />
	<meta property="twitter:url" content={Astro.url} />
	<meta property="twitter:title" content={title} />
	<meta property="twitter:description" content={description} />
	<meta property="twitter:image" content={absoluteOgImage} />
	<link rel="canonical" href={Astro.url} />
	{canonical && <link rel="canonical" href={Astro.url} item-prop="url" />}
	{noindex && <meta name="robots" content="noindex,nofollow" />}
</Fragment>
